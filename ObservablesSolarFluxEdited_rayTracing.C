#ifdef __CLING__
#pragma cling optimize(0)
#endif
void ObservablesSolarFluxEdited_rayTracing()
{
//=========Macro generated from canvas: restplot/restplot
//=========  (Tue May  7 19:02:00 2024) by ROOT version 6.30/04
   TCanvas *restplot = new TCanvas("restplot", "restplot",0,32,800,600);
   restplot->SetHighLightColor(2);
   restplot->Range(0,0,1,1);
   restplot->SetFillColor(0);
   restplot->SetBorderMode(0);
   restplot->SetBorderSize(2);
   restplot->SetFrameBorderMode(0);
  
// ------------>Primitives in pad: restplot_1
   TPad *restplot_1__0 = new TPad("restplot_1", "restplot_1",0.01,0.01,0.99,0.99);
   restplot_1__0->Draw();
   restplot_1__0->cd();
   restplot_1__0->Range(-3.846154,-252,11.53846,1428);
   restplot_1__0->SetFillColor(0);
   restplot_1__0->SetBorderMode(0);
   restplot_1__0->SetBorderSize(2);
   restplot_1__0->SetLeftMargin(0.25);
   restplot_1__0->SetTopMargin(0.07);
   restplot_1__0->SetBottomMargin(0.15);
   restplot_1__0->SetFrameBorderMode(0);
   restplot_1__0->SetFrameBorderMode(0);

   TH1F *final_energy = new TH1F("final_energy","",70,0,10);
   final_energy->SetBinContent(1,3);
   final_energy->SetBinContent(2,21);
   final_energy->SetBinContent(3,46);
   final_energy->SetBinContent(4,83);
   final_energy->SetBinContent(5,180);
   final_energy->SetBinContent(6,268);
   final_energy->SetBinContent(7,366);
   final_energy->SetBinContent(8,478);
   final_energy->SetBinContent(9,566);
   final_energy->SetBinContent(10,713);
   final_energy->SetBinContent(11,770);
   final_energy->SetBinContent(12,839);
   final_energy->SetBinContent(13,951);
   final_energy->SetBinContent(14,983);
   final_energy->SetBinContent(15,1025);
   final_energy->SetBinContent(16,1065);
   final_energy->SetBinContent(17,1158);
   final_energy->SetBinContent(18,1214);
   final_energy->SetBinContent(19,1201);
   final_energy->SetBinContent(20,1248);
   final_energy->SetBinContent(21,1193);
   final_energy->SetBinContent(22,1207);
   final_energy->SetBinContent(23,1160);
   final_energy->SetBinContent(24,1216);
   final_energy->SetBinContent(25,1128);
   final_energy->SetBinContent(26,1117);
   final_energy->SetBinContent(27,1136);
   final_energy->SetBinContent(28,1030);
   final_energy->SetBinContent(29,1054);
   final_energy->SetBinContent(30,1009);
   final_energy->SetBinContent(31,920);
   final_energy->SetBinContent(32,1015);
   final_energy->SetBinContent(33,877);
   final_energy->SetBinContent(34,871);
   final_energy->SetBinContent(35,770);
   final_energy->SetBinContent(36,749);
   final_energy->SetBinContent(37,725);
   final_energy->SetBinContent(38,742);
   final_energy->SetBinContent(39,654);
   final_energy->SetBinContent(40,602);
   final_energy->SetBinContent(41,559);
   final_energy->SetBinContent(42,498);
   final_energy->SetBinContent(43,537);
   final_energy->SetBinContent(44,488);
   final_energy->SetBinContent(45,448);
   final_energy->SetBinContent(46,403);
   final_energy->SetBinContent(47,396);
   final_energy->SetBinContent(48,377);
   final_energy->SetBinContent(49,379);
   final_energy->SetBinContent(50,288);
   final_energy->SetBinContent(51,299);
   final_energy->SetBinContent(52,268);
   final_energy->SetBinContent(53,248);
   final_energy->SetBinContent(54,249);
   final_energy->SetBinContent(55,228);
   final_energy->SetBinContent(56,220);
   final_energy->SetBinContent(57,207);
   final_energy->SetBinContent(58,194);
   final_energy->SetBinContent(59,135);
   final_energy->SetBinContent(60,166);
   final_energy->SetBinContent(61,137);
   final_energy->SetBinContent(62,150);
   final_energy->SetBinContent(63,117);
   final_energy->SetBinContent(64,106);
   final_energy->SetBinContent(65,110);
   final_energy->SetBinContent(66,86);
   final_energy->SetBinContent(67,111);
   final_energy->SetBinContent(68,93);
   final_energy->SetBinContent(69,71);
   final_energy->SetBinContent(70,79);
   final_energy->SetEntries(40000);
   final_energy->SetDirectory(nullptr);
   final_energy->SetStats(0);

   Int_t ci;      // for color index setting
   TColor *color; // for color definition with alpha
   ci = TColor::GetColor("#FFEBEE"); // Soft red color
   final_energy->SetFillColorAlpha(ci, 0.5); // Set soft red color with 50% transparency
   final_energy->SetLineColor(1); // Set line color to black
   final_energy->GetXaxis()->SetTitle("E (keV)");
   final_energy->GetXaxis()->SetLabelFont(42);
   final_energy->GetXaxis()->SetLabelSize(0.0385);
   final_energy->GetXaxis()->SetTitleSize(0.0385);
   final_energy->GetXaxis()->SetTitleOffset(1);
   final_energy->GetXaxis()->SetTitleFont(42);
   final_energy->GetYaxis()->SetTitle("Eventos");
   final_energy->GetYaxis()->SetLabelFont(42);
   final_energy->GetYaxis()->SetLabelSize(0.0385);
   final_energy->GetYaxis()->SetTitleSize(0.0385);
   final_energy->GetYaxis()->SetTitleFont(42);
   final_energy->GetZaxis()->SetLabelFont(42);
   final_energy->GetZaxis()->SetTitleOffset(1);
   final_energy->GetZaxis()->SetTitleFont(42);
   final_energy->Draw("hist");
   
   TH1F *final_energyCond1 = new TH1F("final_energyCond1","",70,0,10);
   final_energyCond1->SetBinContent(2,12);
   final_energyCond1->SetBinContent(3,26);
   final_energyCond1->SetBinContent(4,38);
   final_energyCond1->SetBinContent(5,86);
   final_energyCond1->SetBinContent(6,121);
   final_energyCond1->SetBinContent(7,177);
   final_energyCond1->SetBinContent(8,227);
   final_energyCond1->SetBinContent(9,271);
   final_energyCond1->SetBinContent(10,337);
   final_energyCond1->SetBinContent(11,372);
   final_energyCond1->SetBinContent(12,421);
   final_energyCond1->SetBinContent(13,443);
   final_energyCond1->SetBinContent(14,495);
   final_energyCond1->SetBinContent(15,501);
   final_energyCond1->SetBinContent(16,497);
   final_energyCond1->SetBinContent(17,543);
   final_energyCond1->SetBinContent(18,586);
   final_energyCond1->SetBinContent(19,602);
   final_energyCond1->SetBinContent(20,593);
   final_energyCond1->SetBinContent(21,588);
   final_energyCond1->SetBinContent(22,634);
   final_energyCond1->SetBinContent(23,576);
   final_energyCond1->SetBinContent(24,595);
   final_energyCond1->SetBinContent(25,551);
   final_energyCond1->SetBinContent(26,545);
   final_energyCond1->SetBinContent(27,593);
   final_energyCond1->SetBinContent(28,513);
   final_energyCond1->SetBinContent(29,516);
   final_energyCond1->SetBinContent(30,509);
   final_energyCond1->SetBinContent(31,434);
   final_energyCond1->SetBinContent(32,470);
   final_energyCond1->SetBinContent(33,417);
   final_energyCond1->SetBinContent(34,439);
   final_energyCond1->SetBinContent(35,373);
   final_energyCond1->SetBinContent(36,370);
   final_energyCond1->SetBinContent(37,367);
   final_energyCond1->SetBinContent(38,357);
   final_energyCond1->SetBinContent(39,339);
   final_energyCond1->SetBinContent(40,299);
   final_energyCond1->SetBinContent(41,264);
   final_energyCond1->SetBinContent(42,226);
   final_energyCond1->SetBinContent(43,273);
   final_energyCond1->SetBinContent(44,224);
   final_energyCond1->SetBinContent(45,234);
   final_energyCond1->SetBinContent(46,196);
   final_energyCond1->SetBinContent(47,211);
   final_energyCond1->SetBinContent(48,188);
   final_energyCond1->SetBinContent(49,186);
   final_energyCond1->SetBinContent(50,133);
   final_energyCond1->SetBinContent(51,141);
   final_energyCond1->SetBinContent(52,118);
   final_energyCond1->SetBinContent(53,123);
   final_energyCond1->SetBinContent(54,105);
   final_energyCond1->SetBinContent(55,109);
   final_energyCond1->SetBinContent(56,109);
   final_energyCond1->SetBinContent(57,101);
   final_energyCond1->SetBinContent(58,89);
   final_energyCond1->SetBinContent(59,69);
   final_energyCond1->SetBinContent(60,74);
   final_energyCond1->SetBinContent(61,58);
   final_energyCond1->SetBinContent(62,80);
   final_energyCond1->SetBinContent(63,53);
   final_energyCond1->SetBinContent(64,49);
   final_energyCond1->SetBinContent(65,54);
   final_energyCond1->SetBinContent(66,51);
   final_energyCond1->SetBinContent(67,56);
   final_energyCond1->SetBinContent(68,53);
   final_energyCond1->SetBinContent(69,38);
   final_energyCond1->SetBinContent(70,40);
   final_energyCond1->SetEntries(19538);
   final_energyCond1->SetDirectory(nullptr);
   final_energyCond1->SetStats(0);

   ci = TColor::GetColor("#FFCDD2"); // Darker red color
   final_energyCond1->SetFillColorAlpha(ci, 0.5); // Set dark red color with 50% transparency
   final_energyCond1->SetLineColor(1); // Set line color to black
   final_energyCond1->GetXaxis()->SetTitle("E (keV)");
   final_energyCond1->GetXaxis()->SetLabelFont(42);
   final_energyCond1->GetXaxis()->SetLabelSize(0.0385);
   final_energyCond1->GetXaxis()->SetTitleSize(0.0385);
   final_energyCond1->GetXaxis()->SetTitleOffset(1);
   final_energyCond1->GetXaxis()->SetTitleFont(42);
   final_energyCond1->GetYaxis()->SetTitle("Eventos");
   final_energyCond1->GetYaxis()->SetLabelFont(42);
   final_energyCond1->GetYaxis()->SetLabelSize(0.0385);
   final_energyCond1->GetYaxis()->SetTitleSize(0.0385);
   final_energyCond1->GetYaxis()->SetTitleFont(42);
   final_energyCond1->GetZaxis()->SetLabelFont(42);
   final_energyCond1->GetZaxis()->SetTitleOffset(1);
   final_energyCond1->GetZaxis()->SetTitleFont(42);
   final_energyCond1->Draw("histsame");
   
   TH1F *final_energyCond2__1 = new TH1F("final_energyCond2__1","",70,0,10);
   final_energyCond2__1->SetBinContent(2,10.41121);
   final_energyCond2__1->SetBinContent(3,20.92575);
   final_energyCond2__1->SetBinContent(4,30.24894);
   final_energyCond2__1->SetBinContent(5,67.71094);
   final_energyCond2__1->SetBinContent(6,94.48133);
   final_energyCond2__1->SetBinContent(7,139.387);
   final_energyCond2__1->SetBinContent(8,181.0596);
   final_energyCond2__1->SetBinContent(9,217.425);
   final_energyCond2__1->SetBinContent(10,271.837);
   final_energyCond2__1->SetBinContent(11,301.6733);
   final_energyCond2__1->SetBinContent(12,342.2988);
   final_energyCond2__1->SetBinContent(13,357.1351);
   final_energyCond2__1->SetBinContent(14,395.253);
   final_energyCond2__1->SetBinContent(15,390.6245);
   final_energyCond2__1->SetBinContent(16,325.6457);
   final_energyCond2__1->SetBinContent(17,242.5586);
   final_energyCond2__1->SetBinContent(18,280.4469);
   final_energyCond2__1->SetBinContent(19,301.8881);
   final_energyCond2__1->SetBinContent(20,284.9218);
   final_energyCond2__1->SetBinContent(21,297.104);
   final_energyCond2__1->SetBinContent(22,324.9157);
   final_energyCond2__1->SetBinContent(23,292.938);
   final_energyCond2__1->SetBinContent(24,308.4926);
   final_energyCond2__1->SetBinContent(25,286.3307);
   final_energyCond2__1->SetBinContent(26,290.0517);
   final_energyCond2__1->SetBinContent(27,318.5451);
   final_energyCond2__1->SetBinContent(28,279.4675);
   final_energyCond2__1->SetBinContent(29,283.2756);
   final_energyCond2__1->SetBinContent(30,279.0516);
   final_energyCond2__1->SetBinContent(31,238.6202);
   final_energyCond2__1->SetBinContent(32,262.1892);
   final_energyCond2__1->SetBinContent(33,229.1786);
   final_energyCond2__1->SetBinContent(34,242.5462);
   final_energyCond2__1->SetBinContent(35,203.9066);
   final_energyCond2__1->SetBinContent(36,205.0164);
   final_energyCond2__1->SetBinContent(37,201.7496);
   final_energyCond2__1->SetBinContent(38,197.9215);
   final_energyCond2__1->SetBinContent(39,182.7094);
   final_energyCond2__1->SetBinContent(40,160.7463);
   final_energyCond2__1->SetBinContent(41,140.5359);
   final_energyCond2__1->SetBinContent(42,121.9009);
   final_energyCond2__1->SetBinContent(43,142.4671);
   final_energyCond2__1->SetBinContent(44,119.4141);
   final_energyCond2__1->SetBinContent(45,121.2944);
   final_energyCond2__1->SetBinContent(46,101.1616);
   final_energyCond2__1->SetBinContent(47,106.5301);
   final_energyCond2__1->SetBinContent(48,95.2809);
   final_energyCond2__1->SetBinContent(49,86.01405);
   final_energyCond2__1->SetBinContent(50,56.76212);
   final_energyCond2__1->SetBinContent(51,58.94277);
   final_energyCond2__1->SetBinContent(52,48.76526);
   final_energyCond2__1->SetBinContent(53,53.60908);
   final_energyCond2__1->SetBinContent(54,41.86576);
   final_energyCond2__1->SetBinContent(55,42.70819);
   final_energyCond2__1->SetBinContent(56,37.05208);
   final_energyCond2__1->SetBinContent(57,29.91149);
   final_energyCond2__1->SetBinContent(58,28.91659);
   final_energyCond2__1->SetBinContent(59,23.22312);
   final_energyCond2__1->SetBinContent(60,22.78063);
   final_energyCond2__1->SetBinContent(61,17.88191);
   final_energyCond2__1->SetBinContent(62,28.773);
   final_energyCond2__1->SetBinContent(63,9.989315);
   final_energyCond2__1->SetBinContent(64,12.1693);
   final_energyCond2__1->SetBinContent(65,14.33793);
   final_energyCond2__1->SetBinContent(66,12.614);
   final_energyCond2__1->SetBinContent(67,11.88042);
   final_energyCond2__1->SetBinContent(68,7.841616);
   final_energyCond2__1->SetBinContent(69,5.439195);
   final_energyCond2__1->SetBinContent(70,6.311471);
   final_energyCond2__1->SetBinError(2,3.009201);
   final_energyCond2__1->SetBinError(3,4.110592);
   final_energyCond2__1->SetBinError(4,4.912831);
   final_energyCond2__1->SetBinError(5,7.318764);
   final_energyCond2__1->SetBinError(6,8.602681);
   final_energyCond2__1->SetBinError(7,10.49275);
   final_energyCond2__1->SetBinError(8,12.03447);
   final_energyCond2__1->SetBinError(9,13.22668);
   final_energyCond2__1->SetBinError(10,14.82834);
   final_energyCond2__1->SetBinError(11,15.66196);
   final_energyCond2__1->SetBinError(12,16.70435);
   final_energyCond2__1->SetBinError(13,16.99075);
   final_energyCond2__1->SetBinError(14,17.7915);
   final_energyCond2__1->SetBinError(15,17.48338);
   final_energyCond2__1->SetBinError(16,14.88543);
   final_energyCond2__1->SetBinError(17,10.67126);
   final_energyCond2__1->SetBinError(18,11.77612);
   final_energyCond2__1->SetBinError(19,12.50261);
   final_energyCond2__1->SetBinError(20,11.90323);
   final_energyCond2__1->SetBinError(21,12.43966);
   final_energyCond2__1->SetBinError(22,13.10172);
   final_energyCond2__1->SetBinError(23,12.37808);
   final_energyCond2__1->SetBinError(24,12.84425);
   final_energyCond2__1->SetBinError(25,12.37586);
   final_energyCond2__1->SetBinError(26,12.60519);
   final_energyCond2__1->SetBinError(27,13.2696);
   final_energyCond2__1->SetBinError(28,12.50146);
   final_energyCond2__1->SetBinError(29,12.65092);
   final_energyCond2__1->SetBinError(30,12.54842);
   final_energyCond2__1->SetBinError(31,11.61621);
   final_energyCond2__1->SetBinError(32,12.27601);
   final_energyCond2__1->SetBinError(33,11.38732);
   final_energyCond2__1->SetBinError(34,11.76759);
   final_energyCond2__1->SetBinError(35,10.72201);
   final_energyCond2__1->SetBinError(36,10.84032);
   final_energyCond2__1->SetBinError(37,10.72506);
   final_energyCond2__1->SetBinError(38,10.65976);
   final_energyCond2__1->SetBinError(39,10.13232);
   final_energyCond2__1->SetBinError(40,9.509622);
   final_energyCond2__1->SetBinError(41,8.892702);
   final_energyCond2__1->SetBinError(42,8.336594);
   final_energyCond2__1->SetBinError(43,8.909941);
   final_energyCond2__1->SetBinError(44,8.230071);
   final_energyCond2__1->SetBinError(45,8.234146);
   final_energyCond2__1->SetBinError(46,7.576406);
   final_energyCond2__1->SetBinError(47,7.77803);
   final_energyCond2__1->SetBinError(48,7.443671);
   final_energyCond2__1->SetBinError(49,6.84324);
   final_energyCond2__1->SetBinError(50,5.513639);
   final_energyCond2__1->SetBinError(51,5.670389);
   final_energyCond2__1->SetBinError(52,5.139808);
   final_energyCond2__1->SetBinError(53,5.51725);
   final_energyCond2__1->SetBinError(54,4.836484);
   final_energyCond2__1->SetBinError(55,4.955889);
   final_energyCond2__1->SetBinError(56,4.491965);
   final_energyCond2__1->SetBinError(57,3.987341);
   final_energyCond2__1->SetBinError(58,4.049252);
   final_energyCond2__1->SetBinError(59,3.666032);
   final_energyCond2__1->SetBinError(60,3.696413);
   final_energyCond2__1->SetBinError(61,3.174275);
   final_energyCond2__1->SetBinError(62,4.14958);
   final_energyCond2__1->SetBinError(63,2.264529);
   final_energyCond2__1->SetBinError(64,2.629697);
   final_energyCond2__1->SetBinError(65,2.984609);
   final_energyCond2__1->SetBinError(66,2.754333);
   final_energyCond2__1->SetBinError(67,2.669649);
   final_energyCond2__1->SetBinError(68,2.059056);
   final_energyCond2__1->SetBinError(69,1.736057);
   final_energyCond2__1->SetBinError(70,2.02764);
   final_energyCond2__1->SetEntries(19538);
   final_energyCond2__1->SetDirectory(nullptr);
   final_energyCond2__1->SetStats(0);

   ci = TColor::GetColor("#EF9A9A"); // Darker red color
   final_energyCond2__1->SetFillColorAlpha(ci, 0.5); // Set dark red color with 50% transparency
   final_energyCond2__1->SetLineColor(1); // Set line color to black
   final_energyCond2__1->GetXaxis()->SetTitle("E (keV)");
   final_energyCond2__1->GetXaxis()->SetLabelFont(42);
   final_energyCond2__1->GetXaxis()->SetLabelSize(0.0385);
   final_energyCond2__1->GetXaxis()->SetTitleSize(0.0385);
   final_energyCond2__1->GetXaxis()->SetTitleOffset(1);
   final_energyCond2__1->GetXaxis()->SetTitleFont(42);
   final_energyCond2__1->GetYaxis()->SetTitle("Eventos");
   final_energyCond2__1->GetYaxis()->SetLabelFont(42);
   final_energyCond2__1->GetYaxis()->SetLabelSize(0.0385);
   final_energyCond2__1->GetYaxis()->SetTitleSize(0.0385);
   final_energyCond2__1->GetYaxis()->SetTitleFont(42);
   final_energyCond2__1->GetZaxis()->SetLabelFont(42);
   final_energyCond2__1->GetZaxis()->SetTitleOffset(1);
   final_energyCond2__1->GetZaxis()->SetTitleFont(42);
   final_energyCond2__1->Draw("histsame");
   
   TH1F *final_energyCond3__2 = new TH1F("final_energyCond3__2","",70,0,10);
   final_energyCond3__2->SetBinContent(2,0.0006251202);
   final_energyCond3__2->SetBinContent(3,0.01219229);
   final_energyCond3__2->SetBinContent(4,0.0588502);
   final_energyCond3__2->SetBinContent(5,0.4772939);
   final_energyCond3__2->SetBinContent(6,3.509987);
   final_energyCond3__2->SetBinContent(7,14.76129);
   final_energyCond3__2->SetBinContent(8,32.14727);
   final_energyCond3__2->SetBinContent(9,55.67342);
   final_energyCond3__2->SetBinContent(10,93.73763);
   final_energyCond3__2->SetBinContent(11,132.299);
   final_energyCond3__2->SetBinContent(12,156.6967);
   final_energyCond3__2->SetBinContent(13,181.9135);
   final_energyCond3__2->SetBinContent(14,215.6961);
   final_energyCond3__2->SetBinContent(15,236.1212);
   final_energyCond3__2->SetBinContent(16,207.7345);
   final_energyCond3__2->SetBinContent(17,163.4845);
   final_energyCond3__2->SetBinContent(18,194.551);
   final_energyCond3__2->SetBinContent(19,212.4356);
   final_energyCond3__2->SetBinContent(20,209.6938);
   final_energyCond3__2->SetBinContent(21,227.9119);
   final_energyCond3__2->SetBinContent(22,245.0831);
   final_energyCond3__2->SetBinContent(23,232.8492);
   final_energyCond3__2->SetBinContent(24,237.0708);
   final_energyCond3__2->SetBinContent(25,233.5044);
   final_energyCond3__2->SetBinContent(26,237.328);
   final_energyCond3__2->SetBinContent(27,266.9188);
   final_energyCond3__2->SetBinContent(28,231.0871);
   final_energyCond3__2->SetBinContent(29,234.5802);
   final_energyCond3__2->SetBinContent(30,233.209);
   final_energyCond3__2->SetBinContent(31,206.1085);
   final_energyCond3__2->SetBinContent(32,225.6508);
   final_energyCond3__2->SetBinContent(33,198.4915);
   final_energyCond3__2->SetBinContent(34,213.5832);
   final_energyCond3__2->SetBinContent(35,179.2336);
   final_energyCond3__2->SetBinContent(36,182.4185);
   final_energyCond3__2->SetBinContent(37,179.8012);
   final_energyCond3__2->SetBinContent(38,176.4497);
   final_energyCond3__2->SetBinContent(39,163.029);
   final_energyCond3__2->SetBinContent(40,143.7787);
   final_energyCond3__2->SetBinContent(41,125.7241);
   final_energyCond3__2->SetBinContent(42,111.519);
   final_energyCond3__2->SetBinContent(43,128.237);
   final_energyCond3__2->SetBinContent(44,107.3863);
   final_energyCond3__2->SetBinContent(45,108.5882);
   final_energyCond3__2->SetBinContent(46,92.43756);
   final_energyCond3__2->SetBinContent(47,98.25733);
   final_energyCond3__2->SetBinContent(48,83.40051);
   final_energyCond3__2->SetBinContent(49,81.49602);
   final_energyCond3__2->SetBinContent(50,52.45164);
   final_energyCond3__2->SetBinContent(51,55.30316);
   final_energyCond3__2->SetBinContent(52,46.09232);
   final_energyCond3__2->SetBinContent(53,50.21224);
   final_energyCond3__2->SetBinContent(54,40.71034);
   final_energyCond3__2->SetBinContent(55,39.10426);
   final_energyCond3__2->SetBinContent(56,34.19971);
   final_energyCond3__2->SetBinContent(57,28.78853);
   final_energyCond3__2->SetBinContent(58,27.77332);
   final_energyCond3__2->SetBinContent(59,21.06354);
   final_energyCond3__2->SetBinContent(60,21.19718);
   final_energyCond3__2->SetBinContent(61,16.03621);
   final_energyCond3__2->SetBinContent(62,25.59558);
   final_energyCond3__2->SetBinContent(63,9.938396);
   final_energyCond3__2->SetBinContent(64,11.49802);
   final_energyCond3__2->SetBinContent(65,13.51795);
   final_energyCond3__2->SetBinContent(66,10.83697);
   final_energyCond3__2->SetBinContent(67,11.22658);
   final_energyCond3__2->SetBinContent(68,7.132487);
   final_energyCond3__2->SetBinContent(69,4.760972);
   final_energyCond3__2->SetBinContent(70,6.299442);
   final_energyCond3__2->SetBinError(2,0.0004426532);
   final_energyCond3__2->SetBinError(3,0.004624269);
   final_energyCond3__2->SetBinError(4,0.0143755);
   final_energyCond3__2->SetBinError(5,0.09126792);
   final_energyCond3__2->SetBinError(6,0.4627642);
   final_energyCond3__2->SetBinError(7,1.481312);
   final_energyCond3__2->SetBinError(8,2.823088);
   final_energyCond3__2->SetBinError(9,4.369243);
   final_energyCond3__2->SetBinError(10,6.350279);
   final_energyCond3__2->SetBinError(11,8.156022);
   final_energyCond3__2->SetBinError(12,9.244805);
   final_energyCond3__2->SetBinError(13,10.31222);
   final_energyCond3__2->SetBinError(14,11.54462);
   final_energyCond3__2->SetBinError(15,12.21205);
   final_energyCond3__2->SetBinError(16,10.7955);
   final_energyCond3__2->SetBinError(17,8.033439);
   final_energyCond3__2->SetBinError(18,9.152319);
   final_energyCond3__2->SetBinError(19,9.83428);
   final_energyCond3__2->SetBinError(20,9.692517);
   final_energyCond3__2->SetBinError(21,10.42974);
   final_energyCond3__2->SetBinError(22,10.91591);
   final_energyCond3__2->SetBinError(23,10.65822);
   final_energyCond3__2->SetBinError(24,10.85273);
   final_energyCond3__2->SetBinError(25,10.88092);
   final_energyCond3__2->SetBinError(26,11.08822);
   final_energyCond3__2->SetBinError(27,11.88271);
   final_energyCond3__2->SetBinError(28,11.1305);
   final_energyCond3__2->SetBinError(29,11.28109);
   final_energyCond3__2->SetBinError(30,11.2662);
   final_energyCond3__2->SetBinError(31,10.62963);
   final_energyCond3__2->SetBinError(32,11.20174);
   final_energyCond3__2->SetBinError(33,10.46255);
   final_energyCond3__2->SetBinError(34,10.8996);
   final_energyCond3__2->SetBinError(35,9.941518);
   final_energyCond3__2->SetBinError(36,10.1189);
   final_energyCond3__2->SetBinError(37,10.04058);
   final_energyCond3__2->SetBinError(38,9.975132);
   final_energyCond3__2->SetBinError(39,9.479849);
   final_energyCond3__2->SetBinError(40,8.967506);
   final_energyCond3__2->SetBinError(41,8.362896);
   final_energyCond3__2->SetBinError(42,7.911538);
   final_energyCond3__2->SetBinError(43,8.393809);
   final_energyCond3__2->SetBinError(44,7.779565);
   final_energyCond3__2->SetBinError(45,7.745522);
   final_energyCond3__2->SetBinError(46,7.231174);
   final_energyCond3__2->SetBinError(47,7.412701);
   final_energyCond3__2->SetBinError(48,6.897996);
   final_energyCond3__2->SetBinError(49,6.633856);
   final_energyCond3__2->SetBinError(50,5.264971);
   final_energyCond3__2->SetBinError(51,5.484791);
   final_energyCond3__2->SetBinError(52,5.00469);
   final_energyCond3__2->SetBinError(53,5.314423);
   final_energyCond3__2->SetBinError(54,4.780978);
   final_energyCond3__2->SetBinError(55,4.72104);
   final_energyCond3__2->SetBinError(56,4.28928);
   final_energyCond3__2->SetBinError(57,3.910876);
   final_energyCond3__2->SetBinError(58,3.986253);
   final_energyCond3__2->SetBinError(59,3.467653);
   final_energyCond3__2->SetBinError(60,3.536478);
   final_energyCond3__2->SetBinError(61,3.015338);
   final_energyCond3__2->SetBinError(62,3.901535);
   final_energyCond3__2->SetBinError(63,2.258384);
   final_energyCond3__2->SetBinError(64,2.601891);
   final_energyCond3__2->SetBinError(65,2.922629);
   final_energyCond3__2->SetBinError(66,2.479201);
   final_energyCond3__2->SetBinError(67,2.588765);
   final_energyCond3__2->SetBinError(68,1.943296);
   final_energyCond3__2->SetBinError(69,1.652172);
   final_energyCond3__2->SetBinError(70,2.023777);
   final_energyCond3__2->SetEntries(17078);
   final_energyCond3__2->SetDirectory(nullptr);
   final_energyCond3__2->SetStats(0);

   ci = TColor::GetColor("#E57373"); // Darker red color
   final_energyCond3__2->SetFillColorAlpha(ci, 0.5); // Set dark red color with 50% transparency
   final_energyCond3__2->SetLineColor(1); // Set line color to black
   final_energyCond3__2->GetXaxis()->SetTitle("E (keV)");
   final_energyCond3__2->GetXaxis()->SetLabelFont(42);
   final_energyCond3__2->GetXaxis()->SetLabelSize(0.0385);
   final_energyCond3__2->GetXaxis()->SetTitleSize(0.0385);
   final_energyCond3__2->GetXaxis()->SetTitleOffset(1);
   final_energyCond3__2->GetXaxis()->SetTitleFont(42);
   final_energyCond3__2->GetYaxis()->SetTitle("Eventos");
   final_energyCond3__2->GetYaxis()->SetLabelFont(42);
   final_energyCond3__2->GetYaxis()->SetLabelSize(0.0385);
   final_energyCond3__2->GetYaxis()->SetTitleSize(0.0385);
   final_energyCond3__2->GetYaxis()->SetTitleFont(42);
   final_energyCond3__2->GetZaxis()->SetLabelFont(42);
   final_energyCond3__2->GetZaxis()->SetTitleOffset(1);
   final_energyCond3__2->GetZaxis()->SetTitleFont(42);
   final_energyCond3__2->Draw("histsame");
   
   TH1F *final_energyCond4 = new TH1F("final_energyCond4","",70,0,10);
   final_energyCond4->SetBinContent(2,0);
   final_energyCond4->SetBinContent(3,0);
   final_energyCond4->SetBinContent(4,5.641236e-31);
   final_energyCond4->SetBinContent(5,6.921728e-30);
   final_energyCond4->SetBinContent(6,7.490156e-29);
   final_energyCond4->SetBinContent(7,7.16144e-28);
   final_energyCond4->SetBinContent(8,1.319156e-27);
   final_energyCond4->SetBinContent(9,4.824956e-27);
   final_energyCond4->SetBinContent(10,1.200041e-26);
   final_energyCond4->SetBinContent(11,1.083517e-26);
   final_energyCond4->SetBinContent(12,1.420987e-26);
   final_energyCond4->SetBinContent(13,1.444717e-25);
   final_energyCond4->SetBinContent(14,3.972699e-25);
   final_energyCond4->SetBinContent(15,2.026461e-25);
   final_energyCond4->SetBinContent(16,1.908035e-25);
   final_energyCond4->SetBinContent(17,5.218447e-25);
   final_energyCond4->SetBinContent(18,7.652888e-25);
   final_energyCond4->SetBinContent(19,5.457368e-25);
   final_energyCond4->SetBinContent(20,1.694912e-25);
   final_energyCond4->SetBinContent(21,8.665548e-25);
   final_energyCond4->SetBinContent(22,8.905677e-25);
   final_energyCond4->SetBinContent(23,1.598816e-24);
   final_energyCond4->SetBinContent(24,2.123972e-24);
   final_energyCond4->SetBinContent(25,1.856434e-24);
   final_energyCond4->SetBinContent(26,1.859177e-24);
   final_energyCond4->SetBinContent(27,4.369717e-25);
   final_energyCond4->SetBinContent(28,4.693726e-24);
   final_energyCond4->SetBinContent(29,1.009635e-24);
   final_energyCond4->SetBinContent(30,2.002081e-24);
   final_energyCond4->SetBinContent(31,5.701842e-24);
   final_energyCond4->SetBinContent(32,2.335145e-24);
   final_energyCond4->SetBinContent(33,1.35091e-24);
   final_energyCond4->SetBinContent(34,1.204959e-24);
   final_energyCond4->SetBinContent(35,1.45887e-24);
   final_energyCond4->SetBinContent(36,2.02866e-24);
   final_energyCond4->SetBinContent(37,1.571154e-24);
   final_energyCond4->SetBinContent(38,5.33053e-24);
   final_energyCond4->SetBinContent(39,2.04146e-24);
   final_energyCond4->SetBinContent(40,1.770497e-24);
   final_energyCond4->SetBinContent(41,3.850972e-24);
   final_energyCond4->SetBinContent(42,1.081211e-24);
   final_energyCond4->SetBinContent(43,3.70966e-24);
   final_energyCond4->SetBinContent(44,1.04666e-24);
   final_energyCond4->SetBinContent(45,1.874429e-24);
   final_energyCond4->SetBinContent(46,1.47239e-24);
   final_energyCond4->SetBinContent(47,2.171712e-24);
   final_energyCond4->SetBinContent(48,1.12588e-24);
   final_energyCond4->SetBinContent(49,4.394429e-25);
   final_energyCond4->SetBinContent(50,5.199055e-25);
   final_energyCond4->SetBinContent(51,6.741302e-25);
   final_energyCond4->SetBinContent(52,2.109755e-25);
   final_energyCond4->SetBinContent(53,1.507572e-25);
   final_energyCond4->SetBinContent(54,1.43132e-25);
   final_energyCond4->SetBinContent(55,2.561838e-25);
   final_energyCond4->SetBinContent(56,9.874465e-26);
   final_energyCond4->SetBinContent(57,1.100337e-25);
   final_energyCond4->SetBinContent(58,6.632367e-26);
   final_energyCond4->SetBinContent(59,5.405418e-26);
   final_energyCond4->SetBinContent(60,1.102013e-25);
   final_energyCond4->SetBinContent(61,5.228209e-26);
   final_energyCond4->SetBinContent(62,8.361663e-26);
   final_energyCond4->SetBinContent(63,2.450691e-26);
   final_energyCond4->SetBinContent(64,6.157989e-26);
   final_energyCond4->SetBinContent(65,3.400013e-26);
   final_energyCond4->SetBinContent(66,6.045625e-26);
   final_energyCond4->SetBinContent(67,4.869068e-26);
   final_energyCond4->SetBinContent(68,2.678346e-26);
   final_energyCond4->SetBinContent(69,2.605133e-26);
   final_energyCond4->SetBinContent(70,3.130553e-26);
   final_energyCond4->SetBinError(2,0);
   final_energyCond4->SetBinError(3,0);
   final_energyCond4->SetBinError(4,1.467439e-31);
   final_energyCond4->SetBinError(5,1.473081e-30);
   final_energyCond4->SetBinError(6,1.042305e-29);
   final_energyCond4->SetBinError(7,2.487854e-28);
   final_energyCond4->SetBinError(8,1.228883e-28);
   final_energyCond4->SetBinError(9,1.31644e-27);
   final_energyCond4->SetBinError(10,5.975152e-27);
   final_energyCond4->SetBinError(11,7.498251e-28);
   final_energyCond4->SetBinError(12,8.757583e-28);
   final_energyCond4->SetBinError(13,1.143948e-25);
   final_energyCond4->SetBinError(14,2.448799e-25);
   final_energyCond4->SetBinError(15,1.04997e-25);
   final_energyCond4->SetBinError(16,1.00045e-25);
   final_energyCond4->SetBinError(17,2.536902e-25);
   final_energyCond4->SetBinError(18,4.174745e-25);
   final_energyCond4->SetBinError(19,3.392301e-25);
   final_energyCond4->SetBinError(20,1.1248e-25);
   final_energyCond4->SetBinError(21,4.759726e-25);
   final_energyCond4->SetBinError(22,5.095738e-25);
   final_energyCond4->SetBinError(23,7.762528e-25);
   final_energyCond4->SetBinError(24,9.849215e-25);
   final_energyCond4->SetBinError(25,1.028719e-24);
   final_energyCond4->SetBinError(26,9.591313e-25);
   final_energyCond4->SetBinError(27,3.01704e-25);
   final_energyCond4->SetBinError(28,1.792587e-24);
   final_energyCond4->SetBinError(29,7.730068e-25);
   final_energyCond4->SetBinError(30,1.082547e-24);
   final_energyCond4->SetBinError(31,2.379116e-24);
   final_energyCond4->SetBinError(32,9.580109e-25);
   final_energyCond4->SetBinError(33,9.313909e-25);
   final_energyCond4->SetBinError(34,1.019403e-24);
   final_energyCond4->SetBinError(35,9.909688e-25);
   final_energyCond4->SetBinError(36,9.231242e-25);
   final_energyCond4->SetBinError(37,1.372774e-24);
   final_energyCond4->SetBinError(38,2.699514e-24);
   final_energyCond4->SetBinError(39,9.996844e-25);
   final_energyCond4->SetBinError(40,1.534944e-24);
   final_energyCond4->SetBinError(41,2.190966e-24);
   final_energyCond4->SetBinError(42,6.540855e-25);
   final_energyCond4->SetBinError(43,2.233588e-24);
   final_energyCond4->SetBinError(44,6.343089e-25);
   final_energyCond4->SetBinError(45,1.398944e-24);
   final_energyCond4->SetBinError(46,1.326573e-24);
   final_energyCond4->SetBinError(47,1.448314e-24);
   final_energyCond4->SetBinError(48,9.81815e-25);
   final_energyCond4->SetBinError(49,2.709684e-25);
   final_energyCond4->SetBinError(50,4.1709e-25);
   final_energyCond4->SetBinError(51,4.698603e-25);
   final_energyCond4->SetBinError(52,1.057042e-25);
   final_energyCond4->SetBinError(53,4.771743e-26);
   final_energyCond4->SetBinError(54,4.320406e-26);
   final_energyCond4->SetBinError(55,1.317202e-25);
   final_energyCond4->SetBinError(56,1.431012e-26);
   final_energyCond4->SetBinError(57,3.762655e-26);
   final_energyCond4->SetBinError(58,1.129693e-26);
   final_energyCond4->SetBinError(59,1.014559e-26);
   final_energyCond4->SetBinError(60,3.816937e-26);
   final_energyCond4->SetBinError(61,1.159389e-26);
   final_energyCond4->SetBinError(62,1.494059e-26);
   final_energyCond4->SetBinError(63,6.725786e-27);
   final_energyCond4->SetBinError(64,1.867502e-26);
   final_energyCond4->SetBinError(65,9.246778e-27);
   final_energyCond4->SetBinError(66,1.827685e-26);
   final_energyCond4->SetBinError(67,1.45791e-26);
   final_energyCond4->SetBinError(68,8.890792e-27);
   final_energyCond4->SetBinError(69,1.022089e-26);
   final_energyCond4->SetBinError(70,1.153144e-26);

   // Obtener el contenido máximo del histograma
   double max_content = final_energyCond4->GetMaximum();

   // Multiplicar todos los contenidos del histograma por el factor máximo
   int nbins = final_energyCond4->GetNbinsX(); 
   for (int i = 1; i <= nbins; ++i) {
      double content = final_energyCond4->GetBinContent(i); 
      final_energyCond4->SetBinContent(i, content * (1 / max_content));
   }

   final_energyCond4->SetEntries(17048);
   final_energyCond4->SetDirectory(nullptr);
   final_energyCond4->SetStats(0);

   ci = TColor::GetColor("#EF5350"); // Darker red color
   final_energyCond4->SetFillColorAlpha(ci, 0.5); // Set dark red color with 50% transparency
   final_energyCond4->SetLineColor(1); // Set line color to black
   final_energyCond4->GetXaxis()->SetTitle("E (keV)");
   final_energyCond4->GetXaxis()->SetLabelFont(42);
   final_energyCond4->GetXaxis()->SetLabelSize(0.0385);
   final_energyCond4->GetXaxis()->SetTitleSize(0.0385);
   final_energyCond4->GetXaxis()->SetTitleOffset(1);
   final_energyCond4->GetXaxis()->SetTitleFont(42);
   final_energyCond4->GetYaxis()->SetTitle("Eventos");
   final_energyCond4->GetYaxis()->SetLabelFont(42);
   final_energyCond4->GetYaxis()->SetLabelSize(0.0385);
   final_energyCond4->GetYaxis()->SetTitleSize(0.0385);
   final_energyCond4->GetYaxis()->SetTitleFont(42);
   final_energyCond4->GetZaxis()->SetLabelFont(42);
   final_energyCond4->GetZaxis()->SetTitleOffset(1);
   final_energyCond4->GetZaxis()->SetTitleFont(42);
   final_energyCond4->Draw("histsame");

   TLegend *legend = new TLegend(0.65, 0.7, 0.88, 0.9); 
   legend->AddEntry(final_energy, "Sin peso", "f"); 
   legend->AddEntry(final_energyCond1, "optics_efficiency>0", "f"); 
   legend->AddEntry(final_energyCond2__1, "optics_efficiency", "f"); 
   legend->AddEntry(final_energyCond3__2, "window_transmission", "f");
   legend->AddEntry(final_energyCond4, "axionPhoton_probability", "f");
   legend->Draw(); 

   restplot_1__0->Modified();
   restplot->cd();
   restplot->Modified();
   restplot->SetSelected(restplot);

   // Guardar como PDF
   restplot->SaveAs("ObservablesSolarFlux_rayTracing.pdf");
}
